/* eslint-disable no-unused-vars */
/* eslint-disable @typescript-eslint/no-unused-vars */
import { Service, NedbServiceOptions } from 'feathers-nedb'
import * as WoT from 'wot-typescript-definitions'
import { Id } from '@feathersjs/feathers'
import { Application } from '../../declarations'
// import logger from '../../logger'

// interface SystemLog {
//   service: string
//   level: string
//   message: string
//   _systemId: Id | string
// }

const statusSvgEnum: Record<string, unknown> = {
  idle: `<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" version="1.1">
  <circle cx="50" cy="50" r="50" stroke-width="6" fill="#666666"></circle>
  <text  x="50%" y="50%" text-anchor="middle" fill="white" stroke-width="2px" dy=".3em">IDLE</text>
</svg>`,
  loading: `<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" version="1.1">
  <circle cx="50" cy="50" r="50" stroke-width="6" fill="#007FFF"></circle>
  <text  x="50%" y="50%" text-anchor="middle" fill="white" stroke-width="2px" dy=".3em">LOADING</text>
</svg>`,
  running: `<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" version="1.1">
  <circle cx="50" cy="50" r="50" stroke-width="6" fill="#10D8B1"></circle>
  <text  x="50%" y="50%" text-anchor="middle" fill="white" stroke-width="2px" dy=".3em">RUNNING</text>
</svg>`,
  working: `<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" version="1.1">
  <circle cx="50" cy="50" r="50" stroke-width="6" fill="#5c4ae4"></circle>
  <text  x="50%" y="50%" text-anchor="middle" fill="white" stroke-width="2px" dy=".3em">LOADING</text>
</svg>`,
  stopped: `<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" version="1.1">
  <circle cx="50" cy="50" r="50" stroke-width="6" fill="#FF9933"></circle>
  <text  x="50%" y="50%" text-anchor="middle" fill="white" stroke-width="2px" dy=".3em">STOPPED</text>
</svg>`,
  failed: `<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" version="1.1">
  <circle cx="50" cy="50" r="50" stroke-width="6" fill="#CC0066"></circle>
  <text  x="50%" y="50%" text-anchor="middle" fill="white" stroke-width="2px" dy=".3em">FAILED</text>
</svg>`
}

const statechartSvgEnum: Record<string, unknown> = {
  idle:
    '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="100%" height="auto" viewBox="-0.5 -0.5 702 370"><defs/><g><ellipse cx="438.5" cy="159.65" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 160px; margin-left: 393px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">RUNNING</div></div></div></foreignObject><text x="439" y="165" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">RUNNING</text></switch></g><ellipse cx="47.5" cy="158.81" rx="46.5" ry="46.5" fill="#555555" stroke="#555555" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 159px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #FFFFFF; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">IDLE</div></div></div></foreignObject><text x="47" y="164" fill="#FFFFFF" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">IDLE</text></switch></g><ellipse cx="242.5" cy="159.65" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 160px; margin-left: 197px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">LOADING</div></div></div></foreignObject><text x="242" y="165" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">LOADING</text></switch></g><path d="M 471.38 126.77 Q 481 126.75 481 95.37 Q 481 64 362 64 Q 243 64 243 88.63 Q 243 113.25 242.5 113.15" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="349" y="52" width="47" height="22" stroke-width="0"/><text x="371.77" y="69.46">restart</text></g><path d="M 289 159.65 Q 289 159.65 375.76 159.65" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 389.76 159.65 L 375.76 164.32 L 375.76 154.98 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="317" y="148" width="37" height="22" stroke-width="0"/><text x="334.51" y="165.5">done</text></g><path d="M 94 158.81 Q 140 158.75 140 159.25 Q 140 159.75 179.76 159.75" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 193.76 159.75 L 179.76 164.42 L 179.76 155.08 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="124" y="147" width="33" height="22" stroke-width="0"/><text x="139.58" y="164.59">start</text></g><ellipse cx="633.5" cy="212.65" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 213px; margin-left: 588px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">FAILED</div></div></div></foreignObject><text x="634" y="218" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">FAILED</text></switch></g><path d="M 484.53 165.32 Q 531 165.25 531 189 Q 531 212.75 570.76 212.75" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 584.76 212.75 L 570.76 217.42 L 570.76 208.08 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="523" y="180" width="37" height="22" stroke-width="0"/><text x="540.75" y="197.07">error</text></g><path d="M 680 212.65 Q 700 212.75 700 284.25 Q 700 355.75 467.38 355.75 Q 234.75 355.75 234.78 222.29" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 234.78 208.29 L 239.44 222.29 L 230.11 222.29 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="458" y="344" width="47" height="22" stroke-width="0"/><text x="480.45" y="361.61">restart</text></g><ellipse cx="633.5" cy="95.65" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 96px; margin-left: 588px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">STOPPED</div></div></div></foreignObject><text x="634" y="101" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">STOPPED</text></switch></g><path d="M 485 152.12 Q 531 152 531 123.88 Q 531 95.75 570.76 95.68" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 584.76 95.65 L 570.77 100.35 L 570.76 91.01 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="526" y="117" width="32" height="22" stroke-width="0"/><text x="540.75" y="134.63">stop</text></g><path d="M 680 95.65 Q 700 95.75 700 52.38 Q 700 9 471.25 9 Q 242.5 9 242.5 96.91" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 242.5 110.91 L 237.83 96.91 L 247.17 96.91 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="458" y="-3" width="47" height="22" stroke-width="0"/><text x="480.01" y="14.49">restart</text></g><ellipse cx="400.5" cy="290.36" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 290px; margin-left: 355px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 16.75px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">WORKING</div></div></div></foreignObject><text x="401" y="295" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">WORKING</text></switch></g><path d="M 479.51 179.83 Q 521 179.75 521 235.13 Q 521 290.5 463.24 290.39" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 449.24 290.36 L 463.24 285.72 L 463.23 295.06 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="504" y="225" width="39" height="22" stroke-width="0"/><text x="522.75" y="242.3">work</text></g><path d="M 354 290.36 Q 312 290.5 312 234.63 Q 312 178.75 353 178.75 Q 394 178.75 377.62 178.5" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 391.62 178.44 L 377.64 183.16 L 377.61 173.83 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="295" y="222" width="37" height="22" stroke-width="0"/><text x="312.75" y="239.11">done</text></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>',
  loading:
    '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="100%" height="auto" viewBox="-0.5 -0.5 702 370"><defs/><g><ellipse cx="438.5" cy="161.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 162px; margin-left: 393px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">RUNNING</div></div></div></foreignObject><text x="439" y="167" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">RUNNING</text></switch></g><ellipse cx="47.5" cy="160.78" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 161px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">IDLE</div></div></div></foreignObject><text x="47" y="166" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">IDLE</text></switch></g><ellipse cx="242.5" cy="161.62" rx="46.5" ry="46.5" fill="#007fff" stroke="#007fff" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 162px; margin-left: 197px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #FFFFFF; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">LOADING</div></div></div></foreignObject><text x="242" y="167" fill="#FFFFFF" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">LOADING</text></switch></g><path d="M 471.38 128.74 Q 481 128.75 481 97.38 Q 481 66 362 66 Q 243 66 243 90.5 Q 243 115 242.5 115.12" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="349" y="54" width="47" height="22" stroke-width="0"/><text x="371.77" y="71.46">restart</text></g><path d="M 289 161.62 Q 289 161.62 375.76 161.62" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 389.76 161.62 L 375.76 166.29 L 375.76 156.95 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="317" y="150" width="37" height="22" stroke-width="0"/><text x="334.51" y="167.47">done</text></g><path d="M 94 160.78 Q 140 160.75 140 161.13 Q 140 161.5 179.76 161.5" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 193.76 161.5 L 179.76 166.17 L 179.76 156.83 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="124" y="149" width="33" height="22" stroke-width="0"/><text x="139.83" y="166.34">start</text></g><ellipse cx="633.5" cy="214.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 215px; margin-left: 588px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">FAILED</div></div></div></foreignObject><text x="634" y="220" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">FAILED</text></switch></g><path d="M 484.53 167.29 Q 531 167.25 531 190.88 Q 531 214.5 570.76 214.5" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 584.76 214.5 L 570.76 219.17 L 570.76 209.83 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="523" y="182" width="37" height="22" stroke-width="0"/><text x="540.75" y="199.07">error</text></g><path d="M 680 214.62 Q 700 214.5 700 286.12 Q 700 357.75 467.38 357.75 Q 234.75 357.75 234.78 224.26" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 234.78 210.26 L 239.44 224.26 L 230.11 224.26 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="458" y="346" width="47" height="22" stroke-width="0"/><text x="480.7" y="363.61">restart</text></g><ellipse cx="633.5" cy="97.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 98px; margin-left: 588px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">STOPPED</div></div></div></foreignObject><text x="634" y="103" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">STOPPED</text></switch></g><path d="M 485 154.09 Q 531 154 531 125.75 Q 531 97.5 570.76 97.59" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 584.76 97.62 L 570.75 102.25 L 570.77 92.92 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="526" y="119" width="32" height="22" stroke-width="0"/><text x="540.75" y="136.63">stop</text></g><path d="M 680 97.62 Q 700 97.5 700 54.25 Q 700 11 471.25 11 Q 242.5 11 242.5 98.88" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 242.5 112.88 L 237.83 98.88 L 247.17 98.88 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="457" y="-1" width="47" height="22" stroke-width="0"/><text x="479.76" y="16.49">restart</text></g><ellipse cx="400.5" cy="292.33" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 292px; margin-left: 355px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 16.75px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">WORKING</div></div></div></foreignObject><text x="401" y="297" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">WORKING</text></switch></g><path d="M 479.51 181.8 Q 521 181.75 521 237 Q 521 292.25 463.24 292.31" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 449.24 292.33 L 463.23 287.65 L 463.24 296.98 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="504" y="227" width="39" height="22" stroke-width="0"/><text x="522.75" y="244.3">work</text></g><path d="M 354 292.33 Q 312 292.25 312 236.5 Q 312 180.75 353 180.75 Q 394 180.75 377.62 180.47" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 391.62 180.42 L 377.64 185.14 L 377.6 175.81 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="295" y="223" width="37" height="22" stroke-width="0"/><text x="312.75" y="240.86">done</text></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>',
  running:
    '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="100%" height="auto" viewBox="-0.5 -0.5 702 370"><defs/><g><ellipse cx="438.5" cy="160.62" rx="46.5" ry="46.5" fill="#10d8b1" stroke="#10d8b1" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 161px; margin-left: 393px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #FFFFFF; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">RUNNING</div></div></div></foreignObject><text x="439" y="166" fill="#FFFFFF" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">RUNNING</text></switch></g><ellipse cx="47.5" cy="159.78" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 160px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">IDLE</div></div></div></foreignObject><text x="47" y="165" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">IDLE</text></switch></g><ellipse cx="242.5" cy="160.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 161px; margin-left: 197px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">LOADING</div></div></div></foreignObject><text x="242" y="166" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">LOADING</text></switch></g><path d="M 471.38 127.74 Q 481 127.75 481 96.38 Q 481 65 362 65 Q 243 65 243 89.5 Q 243 114 242.5 114.12" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="349" y="53" width="47" height="22" stroke-width="0"/><text x="371.77" y="70.46">restart</text></g><path d="M 289 160.62 Q 289 160.62 375.76 160.62" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 389.76 160.62 L 375.76 165.29 L 375.76 155.95 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="317" y="149" width="37" height="22" stroke-width="0"/><text x="334.51" y="166.47">done</text></g><path d="M 94 159.78 Q 140 159.75 140 160.13 Q 140 160.5 179.76 160.5" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 193.76 160.5 L 179.76 165.17 L 179.76 155.83 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="124" y="148" width="33" height="22" stroke-width="0"/><text x="139.83" y="165.34">start</text></g><ellipse cx="633.5" cy="213.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 214px; margin-left: 588px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">FAILED</div></div></div></foreignObject><text x="634" y="219" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">FAILED</text></switch></g><path d="M 484.53 166.29 Q 531 166.25 531 189.88 Q 531 213.5 570.76 213.5" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 584.76 213.5 L 570.76 218.17 L 570.76 208.83 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="523" y="181" width="37" height="22" stroke-width="0"/><text x="540.75" y="198.07">error</text></g><path d="M 680 213.62 Q 700 213.5 700 285.13 Q 700 356.75 467.38 356.75 Q 234.75 356.75 234.78 223.26" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 234.78 209.26 L 239.44 223.26 L 230.11 223.26 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="458" y="345" width="47" height="22" stroke-width="0"/><text x="480.7" y="362.61">restart</text></g><ellipse cx="633.5" cy="96.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 97px; margin-left: 588px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">STOPPED</div></div></div></foreignObject><text x="634" y="102" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">STOPPED</text></switch></g><path d="M 485 153.09 Q 531 153 531 124.75 Q 531 96.5 570.76 96.59" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 584.76 96.62 L 570.75 101.25 L 570.77 91.92 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="526" y="118" width="32" height="22" stroke-width="0"/><text x="540.75" y="135.63">stop</text></g><path d="M 680 96.62 Q 700 96.5 700 53.25 Q 700 10 471.25 10 Q 242.5 10 242.5 97.88" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 242.5 111.88 L 237.83 97.88 L 247.17 97.88 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="457" y="-2" width="47" height="22" stroke-width="0"/><text x="479.76" y="15.49">restart</text></g><ellipse cx="400.5" cy="291.33" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 291px; margin-left: 355px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 16.75px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">WORKING</div></div></div></foreignObject><text x="401" y="296" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">WORKING</text></switch></g><path d="M 479.51 180.8 Q 521 180.75 521 236 Q 521 291.25 463.24 291.31" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 449.24 291.33 L 463.23 286.65 L 463.24 295.98 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="504" y="226" width="39" height="22" stroke-width="0"/><text x="522.75" y="243.3">work</text></g><path d="M 354 291.33 Q 312 291.25 312 235.5 Q 312 179.75 353 179.75 Q 394 179.75 377.62 179.47" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 391.62 179.42 L 377.64 184.14 L 377.6 174.81 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="295" y="222" width="37" height="22" stroke-width="0"/><text x="312.75" y="239.86">done</text></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>',
  working:
    '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="100%" height="368px" viewBox="-0.5 -0.5 702 368"><defs/><g><ellipse cx="438.5" cy="159.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 160px; margin-left: 393px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">RUNNING</div></div></div></foreignObject><text x="439" y="165" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">RUNNING</text></switch></g><ellipse cx="47.5" cy="158.78" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 159px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">IDLE</div></div></div></foreignObject><text x="47" y="164" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">IDLE</text></switch></g><ellipse cx="242.5" cy="159.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 160px; margin-left: 197px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">LOADING</div></div></div></foreignObject><text x="242" y="165" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">LOADING</text></switch></g><path d="M 471.38 126.74 Q 481 126.75 481 95.38 Q 481 64 362 64 Q 243 64 243 88.5 Q 243 113 242.5 113.12" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="349" y="52" width="47" height="22" stroke-width="0"/><text x="371.77" y="69.46">restart</text></g><path d="M 289 159.62 Q 289 159.62 375.76 159.62" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 389.76 159.62 L 375.76 164.29 L 375.76 154.95 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="317" y="148" width="37" height="22" stroke-width="0"/><text x="334.51" y="165.47">done</text></g><path d="M 94 158.78 Q 140 158.75 140 159.13 Q 140 159.5 179.76 159.5" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 193.76 159.5 L 179.76 164.17 L 179.76 154.83 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="124" y="147" width="33" height="22" stroke-width="0"/><text x="139.83" y="164.34">start</text></g><ellipse cx="633.5" cy="212.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 213px; margin-left: 588px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">FAILED</div></div></div></foreignObject><text x="634" y="218" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">FAILED</text></switch></g><path d="M 484.53 165.29 Q 531 165.25 531 188.88 Q 531 212.5 570.76 212.5" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 584.76 212.5 L 570.76 217.17 L 570.76 207.83 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="523" y="180" width="37" height="22" stroke-width="0"/><text x="540.75" y="197.07">error</text></g><path d="M 680 212.62 Q 700 212.5 700 284.13 Q 700 355.75 467.38 355.75 Q 234.75 355.75 234.78 222.26" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 234.78 208.26 L 239.44 222.26 L 230.11 222.26 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="458" y="344" width="47" height="22" stroke-width="0"/><text x="480.7" y="361.61">restart</text></g><ellipse cx="633.5" cy="95.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 96px; margin-left: 588px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">STOPPED</div></div></div></foreignObject><text x="634" y="101" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">STOPPED</text></switch></g><path d="M 485 152.09 Q 531 152 531 123.75 Q 531 95.5 570.76 95.59" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 584.76 95.62 L 570.75 100.25 L 570.77 90.92 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="526" y="117" width="32" height="22" stroke-width="0"/><text x="540.75" y="134.63">stop</text></g><path d="M 680 95.62 Q 700 95.5 700 52.25 Q 700 9 471.25 9 Q 242.5 9 242.5 96.88" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 242.5 110.88 L 237.83 96.88 L 247.17 96.88 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="457" y="-3" width="47" height="22" stroke-width="0"/><text x="479.76" y="14.49">restart</text></g><ellipse cx="400.5" cy="290.33" rx="46.5" ry="46.5" fill="#5c4ae4" stroke="#5c4ae4" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 290px; margin-left: 355px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 16.75px; font-family: Helvetica; color: #FFFFFF; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">WORKING</div></div></div></foreignObject><text x="401" y="295" fill="#FFFFFF" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">WORKING</text></switch></g><path d="M 479.51 179.8 Q 521 179.75 521 235 Q 521 290.25 463.24 290.31" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 449.24 290.33 L 463.23 285.65 L 463.24 294.98 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="504" y="225" width="39" height="22" stroke-width="0"/><text x="522.75" y="242.3">work</text></g><path d="M 354 290.33 Q 312 290.25 312 234.5 Q 312 178.75 353 178.75 Q 394 178.75 377.62 178.47" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 391.62 178.42 L 377.64 183.14 L 377.6 173.81 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="295" y="221" width="37" height="22" stroke-width="0"/><text x="312.75" y="238.86">done</text></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>',
  stopped:
    '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="100%" height="auto" viewBox="-0.5 -0.5 702 370"><defs/><g><ellipse cx="438.5" cy="160.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 161px; margin-left: 393px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">RUNNING</div></div></div></foreignObject><text x="439" y="166" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">RUNNING</text></switch></g><ellipse cx="47.5" cy="159.78" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 160px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">IDLE</div></div></div></foreignObject><text x="47" y="165" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">IDLE</text></switch></g><ellipse cx="242.5" cy="160.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 161px; margin-left: 197px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">LOADING</div></div></div></foreignObject><text x="242" y="166" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">LOADING</text></switch></g><path d="M 471.38 127.74 Q 481 127.75 481 96.38 Q 481 65 362 65 Q 243 65 243 89.5 Q 243 114 242.5 114.12" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="349" y="53" width="47" height="22" stroke-width="0"/><text x="371.77" y="70.46">restart</text></g><path d="M 289 160.62 Q 289 160.62 375.76 160.62" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 389.76 160.62 L 375.76 165.29 L 375.76 155.95 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="317" y="149" width="37" height="22" stroke-width="0"/><text x="334.51" y="166.47">done</text></g><path d="M 94 159.78 Q 140 159.75 140 160.13 Q 140 160.5 179.76 160.5" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 193.76 160.5 L 179.76 165.17 L 179.76 155.83 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="124" y="148" width="33" height="22" stroke-width="0"/><text x="139.83" y="165.34">start</text></g><ellipse cx="633.5" cy="213.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 214px; margin-left: 588px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">FAILED</div></div></div></foreignObject><text x="634" y="219" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">FAILED</text></switch></g><path d="M 484.53 166.29 Q 531 166.25 531 189.88 Q 531 213.5 570.76 213.5" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 584.76 213.5 L 570.76 218.17 L 570.76 208.83 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="523" y="181" width="37" height="22" stroke-width="0"/><text x="540.75" y="198.07">error</text></g><path d="M 680 213.62 Q 700 213.5 700 285.13 Q 700 356.75 467.38 356.75 Q 234.75 356.75 234.78 223.26" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 234.78 209.26 L 239.44 223.26 L 230.11 223.26 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="458" y="345" width="47" height="22" stroke-width="0"/><text x="480.7" y="362.61">restart</text></g><ellipse cx="633.5" cy="96.62" rx="46.5" ry="46.5" fill="#ff9933" stroke="#ff9933" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 97px; margin-left: 588px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #FFFFFF; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">STOPPED</div></div></div></foreignObject><text x="634" y="102" fill="#FFFFFF" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">STOPPED</text></switch></g><path d="M 485 153.09 Q 531 153 531 124.75 Q 531 96.5 570.76 96.59" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 584.76 96.62 L 570.75 101.25 L 570.77 91.92 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="526" y="118" width="32" height="22" stroke-width="0"/><text x="540.75" y="135.63">stop</text></g><path d="M 680 96.62 Q 700 96.5 700 53.25 Q 700 10 471.25 10 Q 242.5 10 242.5 97.88" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 242.5 111.88 L 237.83 97.88 L 247.17 97.88 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="457" y="-2" width="47" height="22" stroke-width="0"/><text x="479.76" y="15.49">restart</text></g><ellipse cx="400.5" cy="291.33" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 291px; margin-left: 355px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 16.75px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">WORKING</div></div></div></foreignObject><text x="401" y="296" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">WORKING</text></switch></g><path d="M 479.51 180.8 Q 521 180.75 521 236 Q 521 291.25 463.24 291.31" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 449.24 291.33 L 463.23 286.65 L 463.24 295.98 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="504" y="226" width="39" height="22" stroke-width="0"/><text x="522.75" y="243.3">work</text></g><path d="M 354 291.33 Q 312 291.25 312 235.5 Q 312 179.75 353 179.75 Q 394 179.75 377.62 179.47" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 391.62 179.42 L 377.64 184.14 L 377.6 174.81 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="295" y="222" width="37" height="22" stroke-width="0"/><text x="312.75" y="239.86">done</text></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>',
  failed:
    '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="100%" height="auto" viewBox="-0.5 -0.5 702 370"><defs/><g><ellipse cx="438.5" cy="159.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 160px; margin-left: 393px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">RUNNING</div></div></div></foreignObject><text x="439" y="165" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">RUNNING</text></switch></g><ellipse cx="47.5" cy="158.78" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 159px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">IDLE</div></div></div></foreignObject><text x="47" y="164" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">IDLE</text></switch></g><ellipse cx="242.5" cy="159.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 160px; margin-left: 197px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">LOADING</div></div></div></foreignObject><text x="242" y="165" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">LOADING</text></switch></g><path d="M 471.38 126.74 Q 481 126.75 481 95.38 Q 481 64 362 64 Q 243 64 243 88.5 Q 243 113 242.5 113.12" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="349" y="52" width="47" height="22" stroke-width="0"/><text x="371.77" y="69.46">restart</text></g><path d="M 289 159.62 Q 289 159.62 375.76 159.62" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 389.76 159.62 L 375.76 164.29 L 375.76 154.95 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="317" y="148" width="37" height="22" stroke-width="0"/><text x="334.51" y="165.47">done</text></g><path d="M 94 158.78 Q 140 158.75 140 159.13 Q 140 159.5 179.76 159.5" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 193.76 159.5 L 179.76 164.17 L 179.76 154.83 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="124" y="147" width="33" height="22" stroke-width="0"/><text x="139.83" y="164.34">start</text></g><ellipse cx="633.5" cy="212.62" rx="46.5" ry="46.5" fill="#cc0066" stroke="#cc0066" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 213px; margin-left: 588px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #FFFFFF; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">FAILED</div></div></div></foreignObject><text x="634" y="218" fill="#FFFFFF" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">FAILED</text></switch></g><path d="M 484.53 165.29 Q 531 165.25 531 188.88 Q 531 212.5 570.76 212.5" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 584.76 212.5 L 570.76 217.17 L 570.76 207.83 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="523" y="180" width="37" height="22" stroke-width="0"/><text x="540.75" y="197.07">error</text></g><path d="M 680 212.62 Q 700 212.5 700 284.13 Q 700 355.75 467.38 355.75 Q 234.75 355.75 234.78 222.26" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 234.78 208.26 L 239.44 222.26 L 230.11 222.26 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="458" y="344" width="47" height="22" stroke-width="0"/><text x="480.7" y="361.61">restart</text></g><ellipse cx="633.5" cy="95.62" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 96px; margin-left: 588px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 17px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">STOPPED</div></div></div></foreignObject><text x="634" y="101" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">STOPPED</text></switch></g><path d="M 485 152.09 Q 531 152 531 123.75 Q 531 95.5 570.76 95.59" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 584.76 95.62 L 570.75 100.25 L 570.77 90.92 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="526" y="117" width="32" height="22" stroke-width="0"/><text x="540.75" y="134.63">stop</text></g><path d="M 680 95.62 Q 700 95.5 700 52.25 Q 700 9 471.25 9 Q 242.5 9 242.5 96.88" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 242.5 110.88 L 237.83 96.88 L 247.17 96.88 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="457" y="-3" width="47" height="22" stroke-width="0"/><text x="479.76" y="14.49">restart</text></g><ellipse cx="400.5" cy="290.33" rx="46.5" ry="46.5" fill="none" stroke="#666666" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 91px; height: 1px; padding-top: 290px; margin-left: 355px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 16.75px; font-family: Helvetica; color: #666666; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">WORKING</div></div></div></foreignObject><text x="401" y="295" fill="#666666" font-family="Helvetica" font-size="17px" text-anchor="middle" font-weight="bold">WORKING</text></switch></g><path d="M 479.51 179.8 Q 521 179.75 521 235 Q 521 290.25 463.24 290.31" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 449.24 290.33 L 463.23 285.65 L 463.24 294.98 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="504" y="225" width="39" height="22" stroke-width="0"/><text x="522.75" y="242.3">work</text></g><path d="M 354 290.33 Q 312 290.25 312 234.5 Q 312 178.75 353 178.75 Q 394 178.75 377.62 178.47" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 391.62 178.42 L 377.64 183.14 L 377.6 173.81 Z" fill="#666666" stroke="#666666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g fill="#666666" font-family="Helvetica" text-anchor="middle" font-size="18px"><rect fill="#E1E1E1" stroke="none" x="295" y="221" width="37" height="22" stroke-width="0"/><text x="312.75" y="238.86">done</text></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>'
}

export class Systems extends Service {
  app: Application

  //eslint-disable-next-line @typescript-eslint/no-unused-vars
  constructor(options: Partial<NedbServiceOptions>, app: Application) {
    super(options)
    this.app = app
  }

  async exposeSR(id: Id, srd: WoT.ThingDescription): Promise<void> {
    const sr = this.app.WoT?.srv?.things.get(srd.id) // access things Map with .get(<key>)
    if (sr) {
      await this.destroySR(id, srd) // destroy old System Runtime

      const message = `[core/systems] Producing SRD for system with _id ${id}`
      sr.writeProperty('logs', { message })
    }

    try {
      const sr: WoT.ExposedThing = await this.app.WoT.produce(srd)
      const system = await this.get(id)

      // 1) initialize properties:

      sr.writeProperty('system', system)
      sr.writeProperty(
        'logs',
        await this.app.service('logs').find({
          query: { $sort: { createdAt: -1 }, $limit: 100 },
          paginate: false
        })
      )
      sr.writeProperty(
        'traces',
        await this.app.service('traces').find({
          query: { $sort: { createdAt: -1 }, $limit: 100 },
          paginate: false
        })
      )
      sr.writeProperty('hostOS', '')
      sr.writeProperty('memoryUsage', [])
      sr.writeProperty('resourceUsage', [])
      sr.writeProperty('uptime', 0)
      sr.writeProperty('status', system.status)
      sr.writeProperty('statusSvg', statusSvgEnum[system.status])
      sr.writeProperty('statechartSvg', statechartSvgEnum[system.status])
      sr.writeProperty('mashupLogic', system.mashupLogic)
      sr.writeProperty('seqD', system.seqD)
      sr.writeProperty('codeTS', system.codeTS)
      sr.writeProperty('baseTS', system.baseTS)
      sr.writeProperty('code', system.code)
      sr.writeProperty('base', system.base)
      sr.writeProperty('logs', system.logs)
      sr.writeProperty('step', 'HELLO')

      // 2) override (async) read handlers:

      sr.setPropertyReadHandler('logs', async () =>
        this.app.service('logs').find({
          query: { $sort: { createdAt: -1 }, $limit: 100 },
          paginate: false
        })
      )

      sr.setPropertyReadHandler('traces', async () =>
        this.app.service('traces').find({
          query: { $sort: { createdAt: -1 }, $limit: 100 },
          paginate: false
        })
      )

      // let value = 'running'
      // setInterval(() => {
      //   value =
      //     value === 'idle'
      //       ? 'loading'
      //       : value === 'loading'
      //       ? 'running'
      //       : value === 'running'
      //       ? 'working'
      //       : value === 'working'
      //       ? 'stopped'
      //       : value === 'stopped'
      //       ? 'loading'
      //       : 'loading'
      //   sr.writeProperty('status', value)
      //   sr.writeProperty('statusSvg', statusSvgEnum[value])
      //   sr.writeProperty('statechartSvg', statechartSvgEnum[value])
      // }, 3000)

      sr.setPropertyWriteHandler('status', async (value: unknown) => {
        // sr.writeProperty('status', value)
        sr.writeProperty('statusSvg', statusSvgEnum[value as string])
        sr.writeProperty('statechartSvg', statechartSvgEnum[value as string])
        this.app.service('systems').patch(id, { ...system, status: value })

        switch (value) {
          case 'idle':
            // could emit 'init' event
            break
          case 'loading':
            sr.emitEvent(system.status === 'idle' ? 'start' : 'restart', id)
            break
          case 'running':
            sr.emitEvent('done', id)
            break
          case 'working':
            sr.emitEvent('work', id)
            break
          case 'stopped':
            sr.emitEvent('stop', id)
            break
          case 'failed':
            sr.emitEvent('error', id)
            break
          default:
            break
        }
        return value
      })

      sr.setPropertyWriteHandler('logs', async (value) => {
        const {
          service = 'systems',
          level = 'info',
          message,
          data = {}
        } = value as any

        this.app
          .service('logs')
          .create({ _systemId: id, service, level, message, data })
        // logger[level](message) // log locally as well
        return value
      })

      sr.setPropertyWriteHandler('memoryUsage', async (value: any) => {
        const lastValue: any = await sr.readProperty('memoryUsage')
        return [...lastValue.slice(-24), value]
      })

      sr.setPropertyWriteHandler('resourceUsage', async (value: any) => {
        const lastValue: any = await sr.readProperty('resourceUsage')
        return [...lastValue.slice(-24), value]
      })

      sr.setActionHandler('start', async (params, options) => {
        const message = `[core/systems] Handling 'start' action for system with _id ${id}`
        sr.writeProperty('logs', { message })
        await sr.writeProperty('status', 'loading')
        await sr.writeProperty('status', 'running')
      })

      sr.setActionHandler('restart', async (params, options) => {
        const message = `[core/systems] Handling 'restart' action for system with _id ${id}`
        sr.writeProperty('logs', { message })
        await sr.writeProperty('status', 'loading')
        await sr.writeProperty('status', 'stopped')
        await sr.writeProperty('status', 'running')
      })

      sr.setActionHandler('stop', async (params, options) => {
        const message = `[core/systems] Handling 'stop' action for system with _id ${id}`
        sr.writeProperty('logs', { message })
        await sr.writeProperty('status', 'stopped')
      })

      // 3) call expose() to start serving requests:

      sr.expose().then(() => {
        const title = sr.getThingDescription().title
        const message = `[core/systems] systemRuntime ${title} ready ${id}`
        sr.writeProperty('logs', { message })
      })

      const message = `[core/systems] Exposed systemRuntime for system with _id ${id}`
      sr.writeProperty('logs', { message })
    } catch (error) {
      const message = `[core/systems] ${error}`
      sr.writeProperty('logs', { level: 'error', message })
    }
  }

  async destroySR(id: Id, srd: WoT.ThingDescription): Promise<void> {
    const sr = this.app.WoT?.srv?.things.get(srd.id)
    if (sr) {
      // NOTE: exposedThing.destroy() method not yet implemented
      // by node-wot therefore recurring to call Map.delete(<key>) directly
      // (see https://github.com/eclipse/thingweb.node-wot/issues/155#issuecomment-567568864)
      // TODO: await sr.destroy();

      this.app.WoT?.srv?.things.delete(srd.id)

      // and stop corresponding worker
      const system = await this.app.service('systems').get(id)
      this.app.service('workers').stop(system)

      const message = `[core/systems] Destroyed systemRuntime for system with _id ${id}`
      sr.writeProperty('logs', { message })
    }
  }
}
